---
- hosts: web
  tasks:
    # 在RedHat/CentOS系统上的执行操作
    - block:
        - yum: name=httpd state=present
        - template: src=httpd.conf.j2 dest=/etc/httpd/conf/httpd.conf
        - service: name=httpd state=started enabled=yes
    when: ansible_os_family == 'RedHat'
    sudo: yes

    # 在Debian/Ubuntu系统上的操作
    - block:
        - apt: name=apache2 state=present
        - template: src=httpd.conf.j2 dest=/etc/apache2/apache2.conf
        - service: name=apache2 state=started enabled=yes
    when: ansible_os_family == 'Debian'
    sudo: yes
